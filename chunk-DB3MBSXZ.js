import{a as at,b as lt}from"./chunk-5AJYRDRB.js";import"./chunk-3RTQ72Y6.js";import{t as B}from"./chunk-DCUX3RJ3.js";import{b as Z,c as J,h as K,i as Q,j as X,k as Y}from"./chunk-OOVJ2RK5.js";import"./chunk-UT6QFC45.js";import{a as mt,b as ct}from"./chunk-GCU5MVPG.js";import{a as y,b as C}from"./chunk-GRNZQBTD.js";import{a as tt,b as et,c as it,d as ot,e as nt,f as rt}from"./chunk-Y6CI4VTS.js";import{b as st}from"./chunk-XCJIMQHN.js";import"./chunk-XOSZVAVX.js";import{b as W,d as M,f as T,g as N,j as U,l as z,o as D,q as H,r as $,t as V}from"./chunk-3UMKY4XX.js";import{Aa as c,Fa as p,J as k,Ka as o,La as n,M as v,Ma as m,Ob as A,Sa as h,Ta as P,Tb as O,Tc as G,Uc as R,Vc as q,Xb as E,Zb as b,_b as I,bc as j,d as f,db as a,eb as F,fb as L,ia as l,ma as u,mb as S,p as x,ra as w,wa as g}from"./chunk-OCIATHT5.js";var _=class r{constructor(t,s,e){this.http=t;this.authService=s;this.router=e}apiUrl=`${y.apiUrl}/auth`;oauth2ApiUrl=`${y.oAuth}`;ngOnInit(){window.location.pathname==="/auth/callback"&&this.handleAuthCallback()}loginWithGoogle(){window.location.href=`${this.oauth2ApiUrl}/google`}loginWithFacebook(){window.location.href=`${this.oauth2ApiUrl}/facebook`}loginWithGithub(){window.location.href=`${this.oauth2ApiUrl}/github`}handleAuthCallback(){console.log("social auth callback"),this.http.get(`${this.apiUrl}/user`,{withCredentials:!0}).pipe(x(t=>{t.authenticated?this.authService.getCurrentUser().subscribe(()=>{this.router.navigate(["/groups"])}):this.router.navigate(["/login"])})).subscribe()}static \u0275fac=function(s){return new(s||r)(v(O),v(C),v(b))};static \u0275prov=k({token:r,factory:r.\u0275fac,providedIn:"root"})};var ft=()=>["/register"],vt=()=>["/forgot-password"];function bt(r,t){r&1&&m(0,"mat-progress-bar",2)}function Ct(r,t){r&1&&(o(0,"mat-error"),a(1,"Email is required"),n())}function Mt(r,t){r&1&&(o(0,"mat-error"),a(1,"Email is invalid"),n())}function _t(r,t){r&1&&(o(0,"mat-error"),a(1,"Password is required"),n())}function St(r,t){if(r&1&&(o(0,"div",16),a(1),n()),r&2){let s=P();l(),F(s.errorMessage)}}var dt=class r{constructor(t,s,e,i,d,yt){this.fb=t;this.authService=s;this.socialAuthService=e;this.router=i;this.route=d;this.snackBar=yt}loginForm;isLoading=!1;errorMessage="";ngOnInit(){this.route.queryParams.subscribe(t=>{t.requiresPassword==="true"?this.router.navigate(["/set-password"]):this.router.navigate(["/groups"])}),this.loginForm=this.fb.group({email:["",[M.required,M.email]],password:["",M.required]})}loginWithGoogle(){return f(this,null,function*(){try{this.isLoading=!0,this.errorMessage="",this.socialAuthService.loginWithGoogle()}catch(t){this.handleError(t)}})}loginWithFacebook(){return f(this,null,function*(){try{this.isLoading=!0,this.errorMessage="",this.socialAuthService.loginWithFacebook()}catch(t){this.handleError(t)}})}loginWithGithub(){return f(this,null,function*(){try{this.isLoading=!0,this.errorMessage="",this.socialAuthService.loginWithGithub()}catch(t){this.handleError(t)}})}onSubmit(){if(this.loginForm.valid){let t=this.loginForm.value;this.isLoading=!0,this.errorMessage="",this.authService.login(t).subscribe({next:()=>{this.showSuccessAndRedirect()},error:s=>{this.handleError(s)}})}}showSuccessAndRedirect(){this.isLoading=!1,this.snackBar.open("Login successful","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.router.navigate(["/groups"])}handleError(t){this.isLoading=!1,console.error(t),t.status===401?this.errorMessage="Invalid username or password":t.status===0?this.errorMessage="Unable to connect to the server":this.errorMessage="An error occurred during login. Please try again.",this.snackBar.open(this.errorMessage,"Close",{duration:5e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["error-snackbar"]})}static \u0275fac=function(s){return new(s||r)(u($),u(C),u(_),u(b),u(E),u(B))};static \u0275cmp=w({type:r,selectors:[["app-login"]],decls:47,vars:14,consts:[[1,"login-container"],[1,"login-card"],["mode","indeterminate"],[1,"social-login"],["mat-raised-button","",1,"google-btn",3,"click","disabled"],["src","assets/google-logo.svg","alt","Google logo",1,"social-icon"],["mat-raised-button","",1,"facebook-btn",3,"click","disabled"],["src","assets/facebook-logo.svg","alt","Facebook logo",1,"social-icon"],["mat-raised-button","",1,"github-btn",3,"click","disabled"],["src","assets/github-logo.svg","alt","GitHub logo",1,"social-icon"],[1,"divider"],[1,"divider-text"],[3,"ngSubmit","formGroup"],["appearance","outline"],["matInput","","type","email","formControlName","email","required",""],["matInput","","type","password","formControlName","password","required",""],[1,"error-message"],[1,"form-actions"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-button","","type","button",3,"routerLink"],[1,"register-link"],["mat-button","","color","primary","routerLink","/register"]],template:function(s,e){if(s&1&&(o(0,"div",0)(1,"mat-card",1)(2,"mat-card-header")(3,"mat-card-title"),a(4,"Login"),n()(),g(5,bt,1,0,"mat-progress-bar",2),o(6,"mat-card-content")(7,"div",3)(8,"button",4),h("click",function(){return e.loginWithGoogle()}),m(9,"img",5),a(10," Continue with Google "),n(),o(11,"button",6),h("click",function(){return e.loginWithFacebook()}),m(12,"img",7),a(13," Continue with Facebook "),n(),o(14,"button",8),h("click",function(){return e.loginWithGithub()}),m(15,"img",9),a(16," Continue with GitHub "),n()(),o(17,"div",10),m(18,"mat-divider"),o(19,"span",11),a(20,"or"),n(),m(21,"mat-divider"),n(),o(22,"form",12),h("ngSubmit",function(){return e.onSubmit()}),o(23,"mat-form-field",13)(24,"mat-label"),a(25,"Email"),n(),m(26,"input",14),g(27,Ct,2,0,"mat-error")(28,Mt,2,0,"mat-error"),n(),o(29,"mat-form-field",13)(30,"mat-label"),a(31,"Password"),n(),m(32,"input",15),g(33,_t,2,0,"mat-error"),n(),g(34,St,2,1,"div",16),o(35,"div",17)(36,"button",18),a(37),n(),o(38,"button",19),a(39," Zarejestruj si\u0119 "),n(),o(40,"button",19),a(41," Przypomnij has\u0142o "),n()()()(),o(42,"mat-card-actions")(43,"div",20),a(44," Nie masz konta? "),o(45,"a",21),a(46,"Zarejestruj si\u0119"),n()()()()()),s&2){let i,d;l(5),p(e.isLoading?5:-1),l(3),c("disabled",e.isLoading),l(3),c("disabled",e.isLoading),l(3),c("disabled",e.isLoading),l(8),c("formGroup",e.loginForm),l(5),p(!((i=e.loginForm.get("email"))==null||i.errors==null)&&i.errors.required&&((i=e.loginForm.get("email"))!=null&&i.dirty||(i=e.loginForm.get("email"))!=null&&i.touched)?27:!((i=e.loginForm.get("email"))==null||i.errors==null)&&i.errors.email&&((i=e.loginForm.get("email"))!=null&&i.dirty||(i=e.loginForm.get("email"))!=null&&i.touched)?28:-1),l(6),p((d=e.loginForm.get("password"))!=null&&d.invalid&&((d=e.loginForm.get("password"))!=null&&d.dirty||(d=e.loginForm.get("password"))!=null&&d.touched)?33:-1),l(),p(e.errorMessage?34:-1),l(2),c("disabled",e.loginForm.invalid||e.isLoading),l(),L(" ",e.isLoading?"Logging in...":"Login"," "),l(),c("routerLink",S(12,ft)),l(2),c("routerLink",S(13,vt))}},dependencies:[A,V,U,W,T,N,H,z,D,j,I,Y,X,K,Z,J,Q,q,R,G,rt,tt,ot,it,nt,et,lt,at,st,ct,mt],styles:[".login-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;padding:20px;background-color:#f5f5f5}.login-card[_ngcontent-%COMP%]{width:100%;max-width:430px}mat-card-header[_ngcontent-%COMP%]{justify-content:center;margin-bottom:20px}mat-card-title[_ngcontent-%COMP%]{font-size:24px;margin:0}mat-form-field[_ngcontent-%COMP%]{width:100%;display:block;margin-bottom:16px}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:24px}.form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;padding:8px}.register-link[_ngcontent-%COMP%]{text-align:center;margin:16px 0;width:100%}.error-message[_ngcontent-%COMP%]{color:#f44336;font-size:14px;margin:8px 0;text-align:center}mat-progress-bar[_ngcontent-%COMP%]{margin-bottom:20px}.social-login[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px;margin-bottom:24px;width:400px}.social-login[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:center;gap:8px;padding:0 16px}.social-icon[_ngcontent-%COMP%]{width:20px;height:20px;object-fit:contain;margin-right:8px}.google-btn[_ngcontent-%COMP%]{background-color:#fff;color:#000000de;border:1px solid #dadce0;height:40px;font-family:Roboto,sans-serif;font-weight:500}.facebook-btn[_ngcontent-%COMP%]{background-color:#fff;color:#1877f2;border:1px solid #1877f2;height:40px;font-weight:500}.github-btn[_ngcontent-%COMP%]{background-color:#24292f;color:#fff;height:40px;font-weight:500}.divider[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;margin:24px 0}.divider[_ngcontent-%COMP%]   mat-divider[_ngcontent-%COMP%]{flex:1}.divider-text[_ngcontent-%COMP%]{color:#0000008a;font-size:14px}"]})};export{dt as LoginComponent};
