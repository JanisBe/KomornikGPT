import{a as X,b as Y}from"./chunk-5AJYRDRB.js";import"./chunk-3RTQ72Y6.js";import{t as j}from"./chunk-DCUX3RJ3.js";import{b as G,c as H,h as A,i as D,j as W,k as Z}from"./chunk-OOVJ2RK5.js";import"./chunk-UT6QFC45.js";import{a as $,b as J,c as K,e as Q,f as U}from"./chunk-Y6CI4VTS.js";import{a as ee,b as te}from"./chunk-XCJIMQHN.js";import"./chunk-XOSZVAVX.js";import{b as I,d as f,f as O,g as T,j as z,l as B,o as L,q as N,r as V,t as q}from"./chunk-3UMKY4XX.js";import{Aa as p,Fa as c,Ka as i,La as n,Ma as w,Ob as v,Qa as x,S as C,Sa as M,T as P,Ta as u,Tb as F,Tc as E,Vc as R,Xb as b,Zb as S,_b as k,bc as y,db as s,eb as g,ia as m,ma as l,mb as _,ra as h,wa as d}from"./chunk-OCIATHT5.js";var re=()=>["/login"],ne=()=>["/forgot-password"];function ie(t,a){t&1&&w(0,"mat-progress-bar",2)}function ae(t,a){t&1&&(i(0,"mat-error"),s(1,"Has\u0142o jest wymagane"),n())}function se(t,a){t&1&&(i(0,"mat-error"),s(1,"Has\u0142o musi mie\u0107 co najmniej 6 znak\xF3w"),n())}function me(t,a){t&1&&(i(0,"mat-error"),s(1,"Powt\xF3rzenie has\u0142a jest wymagane"),n())}function le(t,a){t&1&&(i(0,"mat-error"),s(1,"Has\u0142a nie s\u0105 identyczne"),n())}function de(t,a){if(t&1&&(i(0,"div",10),s(1),n()),t&2){let e=u(2);m(),g(e.errorMessage)}}function ce(t,a){if(t&1){let e=x();i(0,"p",5),s(1,"Wprowad\u017A nowe has\u0142o dla swojego konta."),n(),i(2,"form",6),M("ngSubmit",function(){C(e);let r=u();return P(r.onSubmit())}),i(3,"mat-form-field",7)(4,"mat-label"),s(5,"Nowe has\u0142o"),n(),w(6,"input",8),d(7,ae,2,0,"mat-error")(8,se,2,0,"mat-error"),n(),i(9,"mat-form-field",7)(10,"mat-label"),s(11,"Powt\xF3rz has\u0142o"),n(),w(12,"input",9),d(13,me,2,0,"mat-error")(14,le,2,0,"mat-error"),n(),d(15,de,2,1,"div",10),i(16,"div",11)(17,"button",12),s(18," Resetuj has\u0142o "),n()()()}if(t&2){let e,o,r=u();m(2),p("formGroup",r.resetPasswordForm),m(5),c(!((e=r.resetPasswordForm.get("password"))==null||e.errors==null)&&e.errors.required&&((e=r.resetPasswordForm.get("password"))!=null&&e.dirty||(e=r.resetPasswordForm.get("password"))!=null&&e.touched)?7:!((e=r.resetPasswordForm.get("password"))==null||e.errors==null)&&e.errors.minlength&&((e=r.resetPasswordForm.get("password"))!=null&&e.dirty||(e=r.resetPasswordForm.get("password"))!=null&&e.touched)?8:-1),m(6),c(!((o=r.resetPasswordForm.get("confirmPassword"))==null||o.errors==null)&&o.errors.required&&((o=r.resetPasswordForm.get("confirmPassword"))!=null&&o.dirty||(o=r.resetPasswordForm.get("confirmPassword"))!=null&&o.touched)?13:r.resetPasswordForm.errors!=null&&r.resetPasswordForm.errors.passwordMismatch&&((o=r.resetPasswordForm.get("confirmPassword"))!=null&&o.dirty||(o=r.resetPasswordForm.get("confirmPassword"))!=null&&o.touched)?14:-1),m(2),c(r.errorMessage?15:-1),m(2),p("disabled",r.resetPasswordForm.invalid||r.isLoading)}}function pe(t,a){t&1&&(i(0,"div",3)(1,"mat-icon",13),s(2,"check_circle"),n(),i(3,"p"),s(4,"Twoje has\u0142o zosta\u0142o pomy\u015Blnie zresetowane."),n(),i(5,"button",14),s(6," Przejd\u017A do logowania "),n()()),t&2&&(m(5),p("routerLink",_(1,re)))}function ue(t,a){if(t&1&&(i(0,"div",4)(1,"mat-icon",15),s(2,"error"),n(),i(3,"p"),s(4),n(),i(5,"button",14),s(6," Spr\xF3buj ponownie "),n()()),t&2){let e=u();m(4),g(e.tokenError),m(),p("routerLink",_(2,ne))}}var oe=class t{constructor(a,e,o,r,we){this.fb=a;this.http=e;this.route=o;this.router=r;this.snackBar=we;this.resetPasswordForm=this.fb.group({password:["",[f.required,f.minLength(6)]],confirmPassword:["",[f.required]]},{validators:this.passwordMatchValidator})}resetPasswordForm;isLoading=!1;errorMessage="";resetSuccess=!1;tokenError="";token="";ngOnInit(){this.route.queryParams.subscribe(a=>{this.token=a.token,this.token||(this.tokenError="Nieprawid\u0142owy token resetowania has\u0142a")})}passwordMatchValidator(a){let e=a.get("password")?.value,o=a.get("confirmPassword")?.value;return e===o?null:{passwordMismatch:!0}}onSubmit(){if(this.resetPasswordForm.valid&&this.token){this.isLoading=!0,this.errorMessage="";let a=this.resetPasswordForm.get("password")?.value;this.http.post(`/api/reset-password?token=${this.token}`,{password:a}).subscribe({next:()=>{this.isLoading=!1,this.resetSuccess=!0},error:e=>{this.isLoading=!1,console.error(e),e.status===404?this.tokenError="Token resetowania has\u0142a nie zosta\u0142 znaleziony":e.status===400?this.tokenError="Token resetowania has\u0142a wygas\u0142":this.errorMessage="Wyst\u0105pi\u0142 b\u0142\u0105d podczas resetowania has\u0142a. Spr\xF3buj ponownie.",this.snackBar.open(this.errorMessage||this.tokenError,"Zamknij",{duration:5e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["error-snackbar"]})}})}}static \u0275fac=function(e){return new(e||t)(l(V),l(F),l(b),l(S),l(j))};static \u0275cmp=h({type:t,selectors:[["app-reset-password"]],decls:10,vars:2,consts:[[1,"reset-password-container"],[1,"reset-password-card"],["mode","indeterminate"],[1,"success-message"],[1,"error-message-container"],[1,"instruction"],[3,"ngSubmit","formGroup"],["appearance","outline"],["matInput","","type","password","formControlName","password","required",""],["matInput","","type","password","formControlName","confirmPassword","required",""],[1,"error-message"],[1,"form-actions"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["color","primary"],["mat-raised-button","","color","primary","type","button",3,"routerLink"],["color","warn"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"mat-card",1)(2,"mat-card-header")(3,"mat-card-title"),s(4,"Resetowanie has\u0142a"),n()(),d(5,ie,1,0,"mat-progress-bar",2),i(6,"mat-card-content"),d(7,ce,19,5)(8,pe,7,2,"div",3)(9,ue,7,3,"div",4),n()()()),e&2&&(m(5),c(o.isLoading?5:-1),m(2),c(!o.resetSuccess&&!o.tokenError?7:o.resetSuccess?8:9))},dependencies:[v,q,z,I,O,T,N,B,L,y,k,Z,W,A,G,H,D,R,E,U,$,K,Q,J,Y,X,te,ee],styles:[".reset-password-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh;background-color:#f5f5f5}.reset-password-card[_ngcontent-%COMP%]{width:100%;max-width:400px;padding:20px}mat-form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}.form-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;margin-top:16px}.error-message[_ngcontent-%COMP%]{color:#f44336;margin-bottom:16px}.instruction[_ngcontent-%COMP%]{margin-bottom:24px;color:#0009}.success-message[_ngcontent-%COMP%], .error-message-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;text-align:center;padding:24px 0}.success-message[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .error-message-container[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;height:48px;width:48px;margin-bottom:16px}.error-message-container[_ngcontent-%COMP%]{color:#f44336}button[_ngcontent-%COMP%]{margin-top:16px}"]})};export{oe as ResetPasswordComponent};
