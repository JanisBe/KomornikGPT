import{a as re,b as ie,d as oe,e as ne}from"./chunk-5WRDIFU4.js";import"./chunk-3RTQ72Y6.js";import{t as N}from"./chunk-3SQQUEWW.js";import{b as A,c as z,h as H,i as $,j as W,k as Z}from"./chunk-CBJ5GURM.js";import"./chunk-FIU6Q7JL.js";import{a as ae,b as le,c as me}from"./chunk-MX6LO2R2.js";import"./chunk-Z6R5JC6W.js";import{a as O}from"./chunk-YGOLR3EP.js";import"./chunk-ERPTQ7SM.js";import{a as ee,b as te}from"./chunk-WYPXIJJM.js";import{b as k}from"./chunk-E6PGGP4I.js";import{a as J,b as K,c as Q,e as X,f as Y}from"./chunk-T6O22EEE.js";import"./chunk-C347TPR5.js";import{b as j,d,f as q,g as L,j as B,l as T,o as R,q as D,r as U,t as V}from"./chunk-CLIUXEPF.js";import{Aa as _,Fa as m,Ia as P,Ja as F,Ka as o,La as t,Ma as u,Nb as b,Sa as S,Sc as I,Uc as G,Zb as x,ac as y,db as n,fb as w,ia as a,ma as C,nb as E,ra as M,wa as p}from"./chunk-LRQC4R4T.js";var pe=r=>["/groups",r],ue=(r,e)=>e.id;function de(r,e){r&1&&(o(0,"mat-error"),n(1,"Imi\u0119 jest wymagane"),t())}function fe(r,e){r&1&&(o(0,"mat-error"),n(1," Nazwisko jest wymagane"),t())}function ce(r,e){r&1&&(o(0,"mat-error"),n(1,"Email jest wymagany"),t())}function ge(r,e){r&1&&(o(0,"mat-error"),n(1,"Wprowad\u017A poprawny adres email"),t())}function he(r,e){r&1&&(o(0,"mat-error"),n(1,"Obecne has\u0142o jest wymagane"),t())}function ve(r,e){r&1&&(o(0,"mat-error"),n(1,"Nowe has\u0142o musi mie\u0107 conajmniej 8 znak\xF3w"),t())}function Ce(r,e){if(r&1&&(o(0,"mat-list-item",13)(1,"a",14),n(2),t()()),r&2){let l=e.$implicit;a(),_("routerLink",E(2,pe,l.id)),a(),w(" ",l.name," ")}}function _e(r,e){r&1&&(o(0,"mat-list-item"),n(1," Nie nale\u017Cysz do \u017Cadnej grupy. "),t())}var se=class r{constructor(e,l,i,s){this.fb=e;this.authService=l;this.groupService=i;this.snackBar=s;this.profileForm=this.fb.group({name:["",d.required],surname:["",d.required],email:["",[d.required,d.email]],currentPassword:[""],newPassword:["",d.minLength(6)]})}profileForm;isLoading=!1;userGroups=[];ngOnInit(){this.authService.getCurrentUser().subscribe({next:e=>{this.profileForm.patchValue({name:e.name,surname:e.surname,email:e.email})},error:e=>{console.error(e),this.snackBar.open("Error loading user data","Close",{duration:3e3})}}),this.groupService.getGroups().subscribe({next:e=>{this.userGroups=e},error:e=>{console.error(e),this.snackBar.open("Error loading groups","Close",{duration:3e3})}})}onSubmit(){if(this.profileForm.valid){this.isLoading=!0;let e=this.profileForm.get("newPassword")?.value;if(e&&!this.profileForm.get("currentPassword")?.value){this.snackBar.open("Current password is required to change password","Close",{duration:3e3}),this.isLoading=!1;return}let l={name:this.profileForm.get("name")?.value,surname:this.profileForm.get("surname")?.value,email:this.profileForm.get("email")?.value};e&&(l.currentPassword=this.profileForm.get("currentPassword")?.value,l.newPassword=e),this.authService.updateProfile(l).subscribe({next:()=>{this.isLoading=!1,this.snackBar.open("Profile updated successfully","Close",{duration:3e3}),this.profileForm.patchValue({currentPassword:"",newPassword:""})},error:i=>{this.isLoading=!1,this.snackBar.open("Failed to update profile. Please try again.","Close",{duration:3e3,panelClass:["error-snackbar"]}),console.error(i)}})}}static \u0275fac=function(l){return new(l||r)(C(U),C(k),C(O),C(N))};static \u0275cmp=M({type:r,selectors:[["app-profile"]],decls:52,vars:10,consts:[[1,"profile-container"],[1,"profile-card"],[3,"ngSubmit","formGroup"],[1,"form-field"],["appearance","outline"],["matInput","","formControlName","name","required",""],["matInput","","formControlName","surname","required",""],["matInput","","formControlName","email","type","email","required",""],["matInput","","type","password","formControlName","currentPassword"],["matInput","","type","password","formControlName","newPassword"],[1,"form-actions"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[1,"my-4"],[1,"group-item"],[1,"group-link",3,"routerLink"]],template:function(l,i){if(l&1&&(o(0,"div",0)(1,"mat-card",1)(2,"mat-card-header")(3,"mat-card-title"),n(4,"Tw\xF3j profil"),t()(),o(5,"mat-card-content")(6,"form",2),S("ngSubmit",function(){return i.onSubmit()}),o(7,"div",3)(8,"mat-form-field",4)(9,"mat-label"),n(10,"Imi\u0119"),t(),u(11,"input",5),p(12,de,2,0,"mat-error"),t()(),o(13,"div",3)(14,"mat-form-field",4)(15,"mat-label"),n(16,"Nazwisko"),t(),u(17,"input",6),p(18,fe,2,0,"mat-error"),t()(),o(19,"div",3)(20,"mat-form-field",4)(21,"mat-label"),n(22,"Email"),t(),u(23,"input",7),p(24,ce,2,0,"mat-error")(25,ge,2,0,"mat-error"),t()(),o(26,"mat-expansion-panel")(27,"mat-expansion-panel-header")(28,"mat-panel-title"),n(29," Zmie\u0144 has\u0142o "),t()(),o(30,"div",3)(31,"mat-form-field",4)(32,"mat-label"),n(33,"Obecne has\u0142o"),t(),u(34,"input",8),p(35,he,2,0,"mat-error"),t()(),o(36,"div",3)(37,"mat-form-field",4)(38,"mat-label"),n(39,"Nowe has\u0142o"),t(),u(40,"input",9),p(41,ve,2,0,"mat-error"),t()()(),o(42,"div",10)(43,"button",11),n(44),t()()(),u(45,"mat-divider",12),o(46,"h3"),n(47,"Moje grupy"),t(),o(48,"mat-list"),P(49,Ce,3,4,"mat-list-item",13,ue),p(51,_e,2,0,"mat-list-item"),t()()()()),l&2){let s,f,c,g,h,v;a(6),_("formGroup",i.profileForm),a(6),m(!((s=i.profileForm.get("name"))==null||s.errors==null)&&s.errors.required&&((s=i.profileForm.get("name"))!=null&&s.touched)?12:-1),a(6),m(!((f=i.profileForm.get("surname"))==null||f.errors==null)&&f.errors.required&&((f=i.profileForm.get("surname"))!=null&&f.touched)?18:-1),a(6),m(!((c=i.profileForm.get("email"))==null||c.errors==null)&&c.errors.required&&((c=i.profileForm.get("email"))!=null&&c.touched)?24:-1),a(),m(!((g=i.profileForm.get("email"))==null||g.errors==null)&&g.errors.email&&((g=i.profileForm.get("email"))!=null&&g.touched)?25:-1),a(10),m(!((h=i.profileForm.get("currentPassword"))==null||h.errors==null)&&h.errors.required&&((h=i.profileForm.get("currentPassword"))!=null&&h.touched)?35:-1),a(6),m(!((v=i.profileForm.get("newPassword"))==null||v.errors==null)&&v.errors.minlength&&((v=i.profileForm.get("newPassword"))!=null&&v.touched)?41:-1),a(2),_("disabled",!i.profileForm.valid||i.isLoading),a(),w(" ",i.isLoading?"Saving...":"Save Changes"," "),a(5),F(i.userGroups),a(2),m(i.userGroups.length===0?51:-1)}},dependencies:[b,V,B,j,q,L,D,T,R,Y,J,Q,X,K,$,H,A,z,Z,W,G,I,ne,re,ie,oe,te,ee,me,ae,le,y,x],styles:[".profile-container[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:20px}.profile-card[_ngcontent-%COMP%]{width:100%;max-width:600px}.form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}mat-form-field[_ngcontent-%COMP%]{width:100%}.form-actions[_ngcontent-%COMP%]{margin-top:24px;display:flex;justify-content:flex-end}mat-card-header[_ngcontent-%COMP%]{margin-bottom:24px}.my-4[_ngcontent-%COMP%]{margin:24px 0}h3[_ngcontent-%COMP%]{margin:0 0 16px;font-weight:500}.group-item[_ngcontent-%COMP%]{cursor:pointer}.group-item[_ngcontent-%COMP%]:hover{background-color:#0000000a}.group-link[_ngcontent-%COMP%]{text-decoration:none;color:inherit;display:block;width:100%;padding:16px}.group-link[_ngcontent-%COMP%]:hover{color:#1976d2}"]})};export{se as ProfileComponent};
